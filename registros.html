<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de Sorteo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
      color: #333;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    h1 {
      text-align: center;
      color: #007bff;
    }

    .sorteo-info, .form-group {
      margin-bottom: 20px;
      text-align: center;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    input[type="text"] {
      padding: 8px;
      width: 250px;
      margin-right: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .number-selection {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
      margin-bottom: 20px;
    }

    .number-selection input[type="checkbox"] {
      display: none;
    }

    .number-selection label {
      display: inline-block;
      margin: 5px;
      font-size: 18px;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      position: relative;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .number-selection input[type="checkbox"]:disabled + label {
      background-color: #eee;
      color: #999;
      cursor: not-allowed;
      position: relative;
    }

    .number-selection input[type="checkbox"]:disabled + label::before {
      content: 'X';
      font-size: 20px;
      color: #d9534f;
      position: absolute;
      top: 0;
      right: 0;
      transform: translate(50%, -50%);
    }

    .number-selection input[type="checkbox"]:checked + label {
      background-color: #007bff;
      color: white;
      border: 1px solid #007bff;
      transform: scale(1.1);
    }

    button {
      padding: 8px 15px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #0056b3;
    }

    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>Registro de Sorteo</h1>

  <div class="container">
    <div class="sorteo-info">
      <label for="sorteo-name">Nombre del Sorteo:</label>
      <input type="text" id="sorteo-name" required>
    </div>

    <!-- Selección de números de forma visual -->
    <div class="number-selection">
      <!-- Cada input debe tener un ID único y su label correspondiente con el atributo for -->
      <input type="checkbox" id="checkbox-1" value="1">
      <label for="checkbox-1">1</label>

      <input type="checkbox" id="checkbox-2" value="2">
      <label for="checkbox-2">2</label>

      <input type="checkbox" id="checkbox-3" value="3">
      <label for="checkbox-3">3</label>

      <input type="checkbox" id="checkbox-4" value="4">
      <label for="checkbox-4">4</label>

      <input type="checkbox" id="checkbox-5" value="5">
      <label for="checkbox-5">5</label>

      <input type="checkbox" id="checkbox-6" value="6">
      <label for="checkbox-6">6</label>

      <input type="checkbox" id="checkbox-7" value="7">
      <label for="checkbox-7">7</label>

      <input type="checkbox" id="checkbox-8" value="8">
      <label for="checkbox-8">8</label>

      <input type="checkbox" id="checkbox-9" value="9">
      <label for="checkbox-9">9</label>

      <input type="checkbox" id="checkbox-10" value="10">
      <label for="checkbox-10">10</label>
	  
	  <input type="checkbox" id="checkbox-11" value="11">
<label for="checkbox-11">11</label>

<input type="checkbox" id="checkbox-12" value="12">
<label for="checkbox-12">12</label>

<input type="checkbox" id="checkbox-13" value="13">
<label for="checkbox-13">13</label>

<input type="checkbox" id="checkbox-14" value="14">
<label for="checkbox-14">14</label>

<input type="checkbox" id="checkbox-15" value="15">
<label for="checkbox-15">15</label>

<input type="checkbox" id="checkbox-16" value="16">
<label for="checkbox-16">16</label>

<input type="checkbox" id="checkbox-17" value="17">
<label for="checkbox-17">17</label>

<input type="checkbox" id="checkbox-18" value="18">
<label for="checkbox-18">18</label>

<input type="checkbox" id="checkbox-19" value="19">
<label for="checkbox-19">19</label>

<input type="checkbox" id="checkbox-20" value="20">
<label for="checkbox-20">20</label>

<input type="checkbox" id="checkbox-21" value="21">
<label for="checkbox-21">21</label>

<input type="checkbox" id="checkbox-22" value="22">
<label for="checkbox-22">22</label>

<input type="checkbox" id="checkbox-23" value="23">
<label for="checkbox-23">23</label>

<input type="checkbox" id="checkbox-24" value="24">
<label for="checkbox-24">24</label>

<input type="checkbox" id="checkbox-25" value="25">
<label for="checkbox-25">25</label>

<input type="checkbox" id="checkbox-26" value="26">
<label for="checkbox-26">26</label>

<input type="checkbox" id="checkbox-27" value="27">
<label for="checkbox-27">27</label>

<input type="checkbox" id="checkbox-28" value="28">
<label for="checkbox-28">28</label>

<input type="checkbox" id="checkbox-29" value="29">
<label for="checkbox-29">29</label>

<input type="checkbox" id="checkbox-30" value="30">
<label for="checkbox-30">30</label>

<input type="checkbox" id="checkbox-31" value="31">
<label for="checkbox-31">31</label>

<input type="checkbox" id="checkbox-32" value="32">
<label for="checkbox-32">32</label>

<input type="checkbox" id="checkbox-33" value="33">
<label for="checkbox-33">33</label>

<input type="checkbox" id="checkbox-34" value="34">
<label for="checkbox-34">34</label>

<input type="checkbox" id="checkbox-35" value="35">
<label for="checkbox-35">35</label>

<input type="checkbox" id="checkbox-36" value="36">
<label for="checkbox-36">36</label>

<input type="checkbox" id="checkbox-37" value="37">
<label for="checkbox-37">37</label>

<input type="checkbox" id="checkbox-38" value="38">
<label for="checkbox-38">38</label>

<input type="checkbox" id="checkbox-39" value="39">
<label for="checkbox-39">39</label>

<input type="checkbox" id="checkbox-40" value="40">
<label for="checkbox-40">40</label>

<input type="checkbox" id="checkbox-41" value="41">
<label for="checkbox-41">41</label>

<input type="checkbox" id="checkbox-42" value="42">
<label for="checkbox-42">42</label>

<input type="checkbox" id="checkbox-43" value="43">
<label for="checkbox-43">43</label>

<input type="checkbox" id="checkbox-44" value="44">
<label for="checkbox-44">44</label>

<input type="checkbox" id="checkbox-45" value="45">
<label for="checkbox-45">45</label>

<input type="checkbox" id="checkbox-46" value="46">
<label for="checkbox-46">46</label>

<input type="checkbox" id="checkbox-47" value="47">
<label for="checkbox-47">47</label>

<input type="checkbox" id="checkbox-48" value="48">
<label for="checkbox-48">48</label>

<input type="checkbox" id="checkbox-49" value="49">
<label for="checkbox-49">49</label>

<input type="checkbox" id="checkbox-50" value="50">
<label for="checkbox-50">50</label>

<input type="checkbox" id="checkbox-51" value="51">
<label for="checkbox-51">51</label>

<input type="checkbox" id="checkbox-52" value="52">
<label for="checkbox-52">52</label>

<input type="checkbox" id="checkbox-53" value="53">
<label for="checkbox-53">53</label>

<input type="checkbox" id="checkbox-54" value="54">
<label for="checkbox-54">54</label>

<input type="checkbox" id="checkbox-55" value="55">
<label for="checkbox-55">55</label>

<input type="checkbox" id="checkbox-56" value="56">
<label for="checkbox-56">56</label>

<input type="checkbox" id="checkbox-57" value="57">
<label for="checkbox-57">57</label>

<input type="checkbox" id="checkbox-58" value="58">
<label for="checkbox-58">58</label>

<input type="checkbox" id="checkbox-59" value="59">
<label for="checkbox-59">59</label>

<input type="checkbox" id="checkbox-60" value="60">
<label for="checkbox-60">60</label>

<input type="checkbox" id="checkbox-61" value="61">
<label for="checkbox-61">61</label>

<input type="checkbox" id="checkbox-62" value="62">
<label for="checkbox-62">62</label>

<input type="checkbox" id="checkbox-63" value="63">
<label for="checkbox-63">63</label>

<input type="checkbox" id="checkbox-64" value="64">
<label for="checkbox-64">64</label>

<input type="checkbox" id="checkbox-65" value="65">
<label for="checkbox-65">65</label>

<input type="checkbox" id="checkbox-66" value="66">
<label for="checkbox-66">66</label>

<input type="checkbox" id="checkbox-67" value="67">
<label for="checkbox-67">67</label>

<input type="checkbox" id="checkbox-68" value="68">
<label for="checkbox-68">68</label>

<input type="checkbox" id="checkbox-69" value="69">
<label for="checkbox-69">69</label>

<input type="checkbox" id="checkbox-70" value="70">
<label for="checkbox-70">70</label>

<input type="checkbox" id="checkbox-71" value="71">
<label for="checkbox-71">71</label>

<input type="checkbox" id="checkbox-72" value="72">
<label for="checkbox-72">72</label>

<input type="checkbox" id="checkbox-73" value="73">
<label for="checkbox-73">73</label>

<input type="checkbox" id="checkbox-74" value="74">
<label for="checkbox-74">74</label>

<input type="checkbox" id="checkbox-75" value="75">
<label for="checkbox-75">75</label>

<input type="checkbox" id="checkbox-76" value="76">
<label for="checkbox-76">76</label>

<input type="checkbox" id="checkbox-77" value="77">
<label for="checkbox-77">77</label>

<input type="checkbox" id="checkbox-78" value="78">
<label for="checkbox-78">78</label>

<input type="checkbox" id="checkbox-79" value="79">
<label for="checkbox-79">79</label>

<input type="checkbox" id="checkbox-80" value="80">
<label for="checkbox-80">80</label>

<input type="checkbox" id="checkbox-81" value="81">
<label for="checkbox-81">81</label>

<input type="checkbox" id="checkbox-82" value="82">
<label for="checkbox-82">82</label>

<input type="checkbox" id="checkbox-83" value="83">
<label for="checkbox-83">83</label>

<input type="checkbox" id="checkbox-84" value="84">
<label for="checkbox-84">84</label>

<input type="checkbox" id="checkbox-85" value="85">
<label for="checkbox-85">85</label>

<input type="checkbox" id="checkbox-86" value="86">
<label for="checkbox-86">86</label>

<input type="checkbox" id="checkbox-87" value="87">
<label for="checkbox-87">87</label>

<input type="checkbox" id="checkbox-88" value="88">
<label for="checkbox-88">88</label>

<input type="checkbox" id="checkbox-89" value="89">
<label for="checkbox-89">89</label>

<input type="checkbox" id="checkbox-90" value="90">
<label for="checkbox-90">90</label>

<input type="checkbox" id="checkbox-91" value="91">
<label for="checkbox-91">91</label>

<input type="checkbox" id="checkbox-92" value="92">
<label for="checkbox-92">92</label>

<input type="checkbox" id="checkbox-93" value="93">
<label for="checkbox-93">93</label>

<input type="checkbox" id="checkbox-94" value="94">
<label for="checkbox-94">94</label>

<input type="checkbox" id="checkbox-95" value="95">
<label for="checkbox-95">95</label>

<input type="checkbox" id="checkbox-96" value="96">
<label for="checkbox-96">96</label>

<input type="checkbox" id="checkbox-97" value="97">
<label for="checkbox-97">97</label>

<input type="checkbox" id="checkbox-98" value="98">
<label for="checkbox-98">98</label>

<input type="checkbox" id="checkbox-99" value="99">
<label for="checkbox-99">99</label>

<input type="checkbox" id="checkbox-100" value="100">
<label for="checkbox-100">100</label>

<input type="checkbox" id="checkbox-101" value="101">
<label for="checkbox-101">101</label>

<input type="checkbox" id="checkbox-102" value="102">
<label for="checkbox-102">102</label>

<input type="checkbox" id="checkbox-103" value="103">
<label for="checkbox-103">103</label>

<input type="checkbox" id="checkbox-104" value="104">
<label for="checkbox-104">104</label>

<input type="checkbox" id="checkbox-105" value="105">
<label for="checkbox-105">105</label>

<input type="checkbox" id="checkbox-106" value="106">
<label for="checkbox-106">106</label>

<input type="checkbox" id="checkbox-107" value="107">
<label for="checkbox-107">107</label>

<input type="checkbox" id="checkbox-108" value="108">
<label for="checkbox-108">108</label>

<input type="checkbox" id="checkbox-109" value="109">
<label for="checkbox-109">109</label>

<input type="checkbox" id="checkbox-110" value="110">
<label for="checkbox-110">110</label>

<input type="checkbox" id="checkbox-111" value="111">
<label for="checkbox-111">111</label>

<input type="checkbox" id="checkbox-112" value="112">
<label for="checkbox-112">112</label>

<input type="checkbox" id="checkbox-113" value="113">
<label for="checkbox-113">113</label>

<input type="checkbox" id="checkbox-114" value="114">
<label for="checkbox-114">114</label>

<input type="checkbox" id="checkbox-115" value="115">
<label for="checkbox-115">115</label>

<input type="checkbox" id="checkbox-116" value="116">
<label for="checkbox-116">116</label>

<input type="checkbox" id="checkbox-117" value="117">
<label for="checkbox-117">117</label>

<input type="checkbox" id="checkbox-118" value="118">
<label for="checkbox-118">118</label>

<input type="checkbox" id="checkbox-119" value="119">
<label for="checkbox-119">119</label>

<input type="checkbox" id="checkbox-120" value="120">
<label for="checkbox-120">120</label>

<input type="checkbox" id="checkbox-121" value="121">
<label for="checkbox-121">121</label>

<input type="checkbox" id="checkbox-122" value="122">
<label for="checkbox-122">122</label>

<input type="checkbox" id="checkbox-123" value="123">
<label for="checkbox-123">123</label>

<input type="checkbox" id="checkbox-124" value="124">
<label for="checkbox-124">124</label>

<input type="checkbox" id="checkbox-125" value="125">
<label for="checkbox-125">125</label>

<input type="checkbox" id="checkbox-126" value="126">
<label for="checkbox-126">126</label>

<input type="checkbox" id="checkbox-127" value="127">
<label for="checkbox-127">127</label>

<input type="checkbox" id="checkbox-128" value="128">
<label for="checkbox-128">128</label>

<input type="checkbox" id="checkbox-129" value="129">
<label for="checkbox-129">129</label>

<input type="checkbox" id="checkbox-130" value="130">
<label for="checkbox-130">130</label>

<input type="checkbox" id="checkbox-131" value="131">
<label for="checkbox-131">131</label>

<input type="checkbox" id="checkbox-132" value="132">
<label for="checkbox-132">132</label>

<input type="checkbox" id="checkbox-133" value="133">
<label for="checkbox-133">133</label>

<input type="checkbox" id="checkbox-134" value="134">
<label for="checkbox-134">134</label>

<input type="checkbox" id="checkbox-135" value="135">
<label for="checkbox-135">135</label>

<input type="checkbox" id="checkbox-136" value="136">
<label for="checkbox-136">136</label>

<input type="checkbox" id="checkbox-137" value="137">
<label for="checkbox-137">137</label>

<input type="checkbox" id="checkbox-138" value="138">
<label for="checkbox-138">138</label>

<input type="checkbox" id="checkbox-139" value="139">
<label for="checkbox-139">139</label>

<input type="checkbox" id="checkbox-140" value="140">
<label for="checkbox-140">140</label>

<input type="checkbox" id="checkbox-141" value="141">
<label for="checkbox-141">141</label>

<input type="checkbox" id="checkbox-142" value="142">
<label for="checkbox-142">142</label>

<input type="checkbox" id="checkbox-143" value="143">
<label for="checkbox-143">143</label>

<input type="checkbox" id="checkbox-144" value="144">
<label for="checkbox-144">144</label>

<input type="checkbox" id="checkbox-145" value="145">
<label for="checkbox-145">145</label>

<input type="checkbox" id="checkbox-146" value="146">
<label for="checkbox-146">146</label>

<input type="checkbox" id="checkbox-147" value="147">
<label for="checkbox-147">147</label>

<input type="checkbox" id="checkbox-148" value="148">
<label for="checkbox-148">148</label>

<input type="checkbox" id="checkbox-149" value="149">
<label for="checkbox-149">149</label>

<input type="checkbox" id="checkbox-150" value="150">
<label for="checkbox-150">150</label>

    </div>

    <table id="sorteo-table">
      <thead>
        <tr>
          <th>Número</th>
          <th>Nombre</th>
          <th>Sorteo</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="form-group">
      <label for="participant-name">Nombre del Participante:</label>
      <input type="text" id="participant-name" required>
      <button id="add-participant">Agregar Participante</button>
    </div>
  </div>

  <!-- Resto del código JavaScript (igual al original) -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const sorteoNameInput = document.getElementById('sorteo-name');
      const addParticipantButton = document.getElementById('add-participant');
      const sorteoTableBody = document.querySelector('#sorteo-table tbody');
      const participantNameInput = document.getElementById('participant-name');
      const numberCheckboxes = document.querySelectorAll('.number-selection input[type="checkbox"]');
      const registeredNumbers = new Set(); // Set para almacenar números registrados

      // Obtener números registrados al cargar la página
      obtenerNumerosRegistrados();

      addParticipantButton.addEventListener('click', function () {
        const sorteoName = sorteoNameInput.value.trim();
        const participantName = participantNameInput.value.trim();
        
        // Obtener números seleccionados
        const selectedNumbers = Array.from(numberCheckboxes)
          .filter(checkbox => checkbox.checked)
          .map(checkbox => checkbox.value);

        // Validaciones
        if (!sorteoName || selectedNumbers.length === 0 || !participantName) {
          alert("Por favor, completa todos los campos y selecciona al menos un número.");
          return;
        }

        // Agregar participante y números al sorteo
        selectedNumbers.forEach(function (number) {
          // Verificar si el número ya está registrado
          if (!registeredNumbers.has(number)) { // Solo agregar si no está registrado
            const row = document.createElement('tr');
            const numberCell = document.createElement('td');
            const nameCell = document.createElement('td');
            const sorteoCell = document.createElement('td');

            numberCell.textContent = number;
            nameCell.textContent = participantName;
            sorteoCell.textContent = sorteoName;

            row.appendChild(numberCell);
            row.appendChild(nameCell);
            row.appendChild(sorteoCell);
            sorteoTableBody.appendChild(row);

            // Llamada al API para guardar en la base de datos
            guardarParticipanteEnBaseDeDatos(sorteoName, number, participantName);
          } else {
            alert(`El número ${number} ya está registrado.`);
          }
        });

        // Limpiar los campos de entrada
        participantNameInput.value = '';
        numberCheckboxes.forEach(checkbox => checkbox.checked = false);
      });

      function guardarParticipanteEnBaseDeDatos(sorteo, numero, nombre) {
        const url = 'https://prod-02.brazilsouth.logic.azure.com/workflows/e0216dc0080c434f92f90ffda79fd4ff/triggers/manual/paths/invoke/crear_participante?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=lWqG4wSkg3jW3VK7Sl-5oRVdUsijaLZ3BzovP6e86ZA';

        const data = {
          Numero: numero.toString(),
          Nombre: nombre,
          Sorteo: sorteo
        };

        fetch(url, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
          console.log('Participante guardado:', data);
        })
        .catch(error => {
          console.error('Error al guardar participante:', error);
        });
      }

      function obtenerNumerosRegistrados() {
        const url = 'https://prod-21.brazilsouth.logic.azure.com/workflows/a1f66a512b30401f837963fb67c270fb/triggers/manual/paths/invoke/obtener_registros?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=wv5unUjOMZBO6-uen9yvRsJi-ao7WAkE_pB35q_0D7k';

        fetch(url, {
          method: 'GET'
        })
        .then(response => response.json())
        .then(data => {
          console.log('Registros obtenidos:', data);

          // Marcar los checkboxes correspondientes y añadir al Set de números registrados
          data.forEach(registro => {
            registeredNumbers.add(registro.Numero); // Guardar el número como registrado
            const checkbox = document.querySelector(`.number-selection input[value="${registro.Numero}"]`);
            if (checkbox) {
              checkbox.disabled = true; // Desactivar checkbox si el número está registrado
            }

            // Agregar los registros a la tabla
            const row = document.createElement('tr');
            const numberCell = document.createElement('td');
            const nameCell = document.createElement('td');
            const sorteoCell = document.createElement('td');

            numberCell.textContent = registro.Numero;
            nameCell.textContent = registro["Nombre y Apellido"];
            sorteoCell.textContent = registro.Sorteo;

            row.appendChild(numberCell);
            row.appendChild(nameCell);
            row.appendChild(sorteoCell);
            sorteoTableBody.appendChild(row);
          });
        })
        .catch(error => {
          console.error('Error al obtener registros:', error);
        });
      }
    });
  </script>
</body>
</html>
